# config/settings.yaml

app:
  name: "Modular RAG Tool"
  environment: "development"

# 1. LLM SETTINGS
llm:
  mode: "local" # Options: 'local', 'cloud', 'custom'
  
  local:
    provider: "ollama"
    model_name: "mistral" # efficient for CPU
    base_url: "http://localhost:11434"
    
  cloud:
    provider: "openai" # Options: openai, anthropic, google
    model_name: "gpt-4o"

  # Custom Plugin Example:
  # custom:
  #   module_path: "src.plugins.my_llm"
  #   class_name: "MyCustomLLM"
  #   kwargs:
  #     temperature: 0.7
  #     # WARNING: Do not put API keys here! Use os.getenv() in your plugin code.

embedding:
  provider: "huggingface" # Options: huggingface (local), openai (cloud), custom
  
  huggingface:
    model_name: "sentence-transformers/all-MiniLM-L6-v2" # Small, fast, good for CPU
  
  openai:
    model_name: "text-embedding-3-small"

  google:
    model_name: "models/text-embedding-004"

  # Custom Plugin Example:
  # custom:
  #   module_path: "src.plugins.my_embeddings"
  #   class_name: "MyEmbeddings"

# 3. VECTOR STORE SETTINGS
vector_db:
  provider: "chroma" # Options: chroma (local), pinecone (cloud), custom
  
  persist_directory: "./chroma_db"
  collection_name: "rag_collection"
  
  pinecone:
    index_name: "rag-index"

  # Custom Plugin Example:
  # custom:
  #   module_path: "src.plugins.my_vectorstore"
  #   class_name: "MyVectorStore"

# 3. HARDWARE SETTINGS
compute:
  device: "cpu" # Options: cpu, cuda (The code will auto-detect, but this acts as a force override)

# 4. BEHAVIOR
rag:
  fallback_to_general_chat: true # If no docs found, chat normally
  score_threshold: 1.5 # Distance threshold (Lower is better for Cosine/Euclidean in Chroma)

# 5. MEMORY SETTINGS
memory:
  provider: "local" # Options: 'local', 'redis', 'custom'
  type: "window"    # Options: 'window', 'summary', 'vector'
  
  window_size: 10   # Only used if type is 'window'
  
  vector_memory:
    collection_name: "chat_memory"
    k: 5 # Number of past messages to retrieve
  
  local:
    file_path: "chat_history.json"
    
  redis:
    url: "redis://localhost:6379"
    ttl: 86400 # 24 hours

  # Custom Plugin Example (e.g. Postgres, DynamoDB):
  # custom:
  #   module_path: "src.plugins.my_memory"
  #   class_name: "MyPostgresMemory"
  #   kwargs:
  #     connection_string: "postgresql://..."

# 6. GUARDRAILS SETTINGS
guardrails:
  enabled: true # Master switch for all guardrails
  
  # Individual validator configurations
  validators:
    # Detects prompt injection attack patterns
    prompt_injection:
      enabled: true
      patterns: "default"  # Options: "default", "strict", or custom list
    
    # Validates input length limits
    input_length:
      enabled: true
      max_length: 10000
    
    # Detects excessive special characters
    special_characters:
      enabled: true
      max_ratio: 0.3  # 30% maximum
    
    # Detects and redacts PII from outputs
    pii_detector:
      enabled: true
      redact_types: ["email", "phone", "ssn", "credit_card"]
    
    # Validates input is not empty
    empty_input:
      enabled: true

    # Restricts queries to specific topics (Requires LLM)
    topic_restriction:
      enabled: false # Enable and set topics to use
      allowed_topics: ["general knowledge", "technology", "science"]

    # Filters toxic content (Requires LLM)
    toxicity_filter:
      enabled: false # Enable to filter harmful content

    # Custom Validator Example:
    # my_custom_check:
    #   enabled: true
    #   module_path: "src.plugins.my_validator"
    #   class_name: "MyValidator"